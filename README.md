# Analyzing the effects of climate change on vegetation dynamics using functional data analysis
## Theresa Meier - Master's Thesis

This repository contains code and plots for the analysis of climate change on vegetation dynamics in the boreal forest using functional data analysis techniques such as functional principal component analysis (FPCA) and functional linear regression (FLR). All computations are performed on a Linux system with an AMD Ryzen 5 5625U and 16 GB of RAM using R 4.4.0. 

The repository is built as follows:

- Folder [00_Database](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/00_Database) consists of a file to build the database from the raw output data of the LPJ-GUESS dynamic vegetation model. It brings the data into a suitable form for further analysis. This code has been provided by project partner Lucia Layritz.

- The [01_Description](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/01_Description) folder contains files for descriptive analysis, including maps, plots for ecological, soil and climate variables, and recovery trajectories. 
- The first approach to performing FPCA can be found in [02_FPCA](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/02_FPCA). The univariate scenario and PFT-wise FPCAs are conducted in the file *FPCA_univ.R*, while the derived PC scores are clustered in *FPCA_clustering.R*. The final file, *FPCA_ex.R*, plots a sample curve of functional data. All calculations are based on the R package [`fda`](https://github.com/cran/fda) developed by J. Ramsay, G. Hooker and S. Graves (2009).
- To address the multivariate structure of the recovery trajectories for five different PFTs, file *MFPCA_all.R* in [03_MFPCA/MFPCA](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/03_MFPCA/MFPCA) performs a multivariate functional principal component (MFPCA) using the R package [`MFPCA`](https://github.com/ClaraHapp/MFPCA) developed by C. Happ-Kurz (2020). Therefore, in the file *MFPCA_calculation.R*, some functions from the original `MFPCA` package are modified to fit the requirements of the data at hand. The folder [03_MFPCA/Clustering](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/03_MFPCA/Clustering) contains files for clustering the PC scores and additional investigations of cluster-specifying properties with respect to soil, ecological and climatic variables. The file *MFPCA_temporal_clustering_single.R* can be used to derive results on the temporal consistency of the cluster assignment.
- Folder [04_Model](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/04_Model) consists of the main part of this project, the modelling approach. Because the data are multivariate, a multivariate functional linear regression (mFLR) is fitted to the previously derived MFPCA scores. As the climate covariates are also in functional form, an MFPCA is performed in the file *MFPCA_climate.R*. The resulting scores are used for modelling in both *mFLR_Patch1.R* and *mFLR_AllPatches.R*, the former fitting a generalised additive model (GAM) to data from only one patch and the latter to all 25 available patches to derive appropriate confidence bands. All required data and models are stored in the respective subfolders.
- All plots that are within the final Master's Thesis are stored in [05_Plots](https://github.com/TheresaMeier/MA_FDA_veg/tree/main/05_Plots).

The data for the scripts is not publicly available and therefore not part of this repository, which may cause some of the scripts to not compile correctly.
