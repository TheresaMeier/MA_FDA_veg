---
title: "Analysing the effects of climate change and forest disturbance on vegetation dynamics in the boreal forest"
author: "Theresa Meier, 11.04.2024"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


***

## Descriptive Analysis

***

### Data Set Description

The data set consists of four separate tables for four different climate scenarios:

- **Control**: A control scenario. This was created by running a climate model for constant pre-industrial CO2 emission but considering interannual variability (e.g. El Niño)
- **SSP1-RCP2.6**: A best case scenario in line with the Paris agreement
- **SSP1-RCP7.0**: A medium scenario
- **SSP1-RCP8.5**: A worst case climate scenario (sometimes referred to as business as usual (BAU)). This is useful for understanding extreme effects. Despite the name it is however not considered a likely scenario currently.

For each scenario, the following variables are provided:

- `Year`: Simulation year
- `Lon`: Longitude of grid cell
- `Lat`: Latitude of grid cell
- `PID`: Patch ID
- `PFT`: Plant functional type, here: 

  - **BNE:** Boreal needleleaf evergreen trees
  
  - **IBS:** Pioneering broadleafed summergreen trees
  
  - **TeBS:** Temperate broadleafed summergreen trees
  
  - **Tundra:** various grass and shrub PFTs, already aggegated
  
  - **otherC:** all coniferious PFTs, already aggregated
  
- `dhist`: Disturbance history, 1 if disturbances occurred in a year, 0 otherwise.
- `ndist`: Number of disturbances in that patch since the start of the simulation.
- `age`: Patch age, i.e. time since last disturbance
- `cmass`: Aboveground carbon in kg/m² (target variable)

The data provided would also consist of additional variables like `lai` (Leaf area index) or `dens` (tree density). Since the primary target is `cmass`, the possible other variables are not under consideration at this moment. This is also due to memory issues of the full data base.

***

### Variables
First, let's take a look at some general overview and summary statistics concerning the data. 

***

#### Geographical expansion
In total, the data comprises **5156 different grid cells** in the boreal forest biome, defined by their centroids, and each grid cell consists of **25 independent patches**. The grid cells and the respective areas are displayed in Figure 1:

![**Figure 1:** Area of concern in this study. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/worldmap.png)

***

#### Simulation period and set up
The simulation spans the years 1800 to 2300, considering different phases. First, from 1800 to 1900, a **spinup** phase is used to develop a baseline vegetation in each patch, i.e. the model is span up recycling the pre-industrial climate of 1850 to 1879. For the three climate scenarios, the **historical warming** is used to simulate until 2015, while for the control scenario no warming is assumed. From 2015 to 2100 is the **experimental phase**, which includes running the simulation for each climate scenario and a return period of disturbances of 150 years (i.e. $p_D = 0.0067$). After 2100 until the end of the simulation in year 2299, the model is run recycling data from 2095 to 2100 (**spindown**).

Note that the simulation only plays with the number of disturbances per year while keeping the intensity and size constant.

***

#### Variables `age` and `ndist`
Figure 2 shows the age distribution of each scenario, i.e. the **maximum age achieved in each patch** over the whole simulation. Obviously, the age of the patches, i.e. the time since the last disturbance, does not really differ between the scenarios. Thus, one can not follow that the vegetation in the control scenario grows older than in the warming scenarios.

![**Figure 2:** Age distribution for each scenario. Mean values are displayed in red. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/age_dist.png)

***

This pattern is also visible looking at the distribution of disturbances per year (which is directly connected to the age!). Figure 3 shows a histogram of the annual number of disturbances in the whole area. Again, no big differences between the four climate scenarios are present. (Note that $\frac{34}{5456} \approx 0.006 \approx p_D$.)

![**Figure 3:** Number of annual disturbances for each scenario in the whole simulated area. Mean values are displayed in red. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/ndist_dist.png)

***

#### Response `cmass`

Now, let's take a look at the response variable `cmass`. Figure 4 shows the average annual aboveground biomass in kg/m² for each of the five PFTs. Here, all patches and the whole study area are considered. It is obvious that the distribution of the vegetation is rather constant in the spinup phase and begins to vary with the start of the experiment phase. Interestingly, the higher the climate warming, the more expressed are pioneering and temperate broadleaf. On the other hand, needleleaf evergreen, which is the dominating vegetation in the control scenario, loose importance with the increase in temperature.


![**Figure 4:** Average annual aboveground biomass in kg/m² for all patches over the whole simulated area. The grey box indicates the experiment phase. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/mean_cmass_dist.png)

***

One important aspect of answering the research questions at hand is the regeneration process of the vegetation after a disturbance. In Figure 5, the recovery trajectories for one patch disturbed between 2015 and 2045 is displayed for all four scenarios. The PFT composition clearly follows similar patterns (e.g. Tundra comes first and decreased with passing time), but especially the dominant vegetation after 100 years differs. The more drastic the scenario, the more dominant get pioneering broadleaf, while the importance of needleleaf evergreen diminishes (similar as in Figure 4).

![**Figure 5:** Recovery trajectories for one patch which is disturbed between 2015 and 2040. The bold curves symbolize mean values. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/g_regeneration.png)

***

As a reference, the same is depicted for disturbances between 2100 and 2150 in Figure 6. There are clearly substantial differences to the vegetation composition before.While the control scenario doesn't change much, in the scenarios, after the experimental phase, needleleaf evergreen and temperate broadleaf become more dominant in the later period.


![**Figure 6:** Recovery trajectories for one patch which is disturbed between 2100 and 2150. The bold curves symbolize mean values. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/g_regeneration_2100_2150.png)

***

Note that in addition, the behavior of recovery for different number of previous events was examined. As expected, the number of previous disturbances does not affect the regeneration of the vegetation, i.e. the regeneration process is always the same and independent of previous disturbances.

***

### Spatial Distribution
As a last step, the development of the vegetational composition over time for each scenario is plotted for each grid cell and one patch. Figure 7 shows the evolution as gif for the control scenario, Figure 8, 9 and 10 for the three climate warming scenarios. The pattern detected in Figure 4 is also present here.


![**Figure 7:** Spatial development of the dominant vegetation for year 2015, 2100, 2200 and 2296 for one patch and the control scenario. The grid cell's colour is according to the dominant vegetation type in the respective cell. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/gif_picontrol.gif)

***

![**Figure 8:** Spatial development of the dominant vegetation for year 2015, 2100, 2200 and 2296 for one patch and the SSP1-RCP2.6 scenario. The grid cell's colour is according to the dominant vegetation type in the respective cell. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/gif_ssp126.gif)

***

![**Figure 9:** Spatial development of the dominant vegetation for year 2015, 2100, 2200 and 2296 for one patch and the SSP1-RCP7.0 scenario. The grid cell's colour is according to the dominant vegetation type in the respective cell. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/gif_ssp370.gif)


***

![**Figure 10:** Spatial development of the dominant vegetation for year 2015, 2100, 2200 and 2296 for one patch and the SSP1-RCP8.5 scenario. The grid cell's colour is according to the dominant vegetation type in the respective cell. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/gif_ssp585.gif)

***

As an overview, Figure 11 shows all four scenarios simultaneously.

![**Figure 11:** Spatial development of the dominant vegetation for year 2015, 2100, 2200 and 2296 for one patch and all four scenarios. The grid cell's colour is according to the dominant vegetation type in the respective cell. ](/home/theresa/Schreibtisch/Theresa/STUDIUM/Master Statistics and Data Science/Masterarbeit/Scripts/Plots/Descriptive/gif_veg.gif)